(()=>{"use strict";var e={67:(e,t,n)=>{n.r(t),n.d(t,{AmazonConnectApp:()=>l,AppContactScope:()=>i,LifecycleManager:()=>a});var s=n(968);class r extends s._y{constructor(e,t,n,s){super(e),this.appInstanceId=t,this.appConfig=n,this.contactScope=s}}var i,o=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};class a{constructor(e){this.provider=e,this.startHandlers=new Set,this.stopHandlers=new Set,this.state={isRunning:!1},this.isCreated=!1,this.isDestroyed=!1,this.logger=new s.Hb({source:"app.lifecycleManager",provider:e,mixin:()=>({state:this.state,isCreated:this.isCreated,isDestroyed:this.isDestroyed})})}handleLifecycleChangeMessage(e){const t=new r(this.provider,e.appInstanceId,e.appConfig,e.contactScope);this.state.appInstanceId=e.appInstanceId,this.state.appConfig=e.appConfig,this.state.contactScope=e.contactScope;const n={context:t};switch(e.stage){case"create":return this.handleCreate(n);case"start":return this.handleStart(n);case"stop":return this.handleStop(n);case"destroy":return this.handleDestroy(n)}}onStart(e,t){this.startHandlers.add(e),(null==t?void 0:t.invokeIfRunning)&&this.state.isRunning&&this.handleLifecycleChange(Object.assign(Object.assign({},this.getLifecycleChangeParams()),{stage:"start"}),(t=>e(t)),!1)}onStop(e){this.stopHandlers.add(e)}offStart(e){this.startHandlers.delete(e)}offStop(e){this.stopHandlers.delete(e)}get appState(){return Object.assign({},this.state)}handleCreate(e){return o(this,void 0,void 0,(function*(){var t;if(this.isDestroyed)return void this.logger.error("An attempt was Create after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(this.isCreated)return void this.logger.error("An attempt was invoke Create after it was already invoked. No Action",{appInstanceId:e.context.appInstanceId});if(this.logger.debug("Begin Lifecycle Create",{appInstanceId:e.context.appInstanceId}),!(null===(t=this.provider.config)||void 0===t?void 0:t.onCreate)){const t="App did not specify an onCreated handler. This is required. Closing app",n={appInstanceId:e.context.appInstanceId};return this.logger.error(t,{appInstanceId:e.context.appInstanceId}),void this.provider.sendFatalError(t,n)}const{success:n}=yield this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"create"}),(e=>this.provider.config.onCreate(e)),!0);n&&(this.isCreated=!0,this.sendLifecycleHandlerCompletedMessage(e.context.appInstanceId,"create"))}))}handleStart(e){return o(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was Start after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Start before Create. No Action",{appInstanceId:e.context.appInstanceId});this.state.isRunning=!0,this.logger.info("Begin Lifecycle Start");const t=yield Promise.all([...this.startHandlers].map((t=>this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"start"}),(e=>t(e)),!1))));this.logger.debug("Completed all start handlers",{count:this.startHandlers.size,errorCount:t.filter((({success:e})=>!e)).length})}))}handleStop(e){return o(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was Stop after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Stop before Create. No Action",{appInstanceId:e.context.appInstanceId});this.state.isRunning=!1,this.logger.info("Begin Lifecycle Stop");const t=yield Promise.all([...this.stopHandlers].map((t=>this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"stop"}),(e=>t(e)),!1))));this.logger.debug("Completed all stop handlers",{count:this.stopHandlers.size,errorCount:t.filter((({success:e})=>!e)).length})}))}handleDestroy(e){return o(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was invoke Destroy multiple times. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Destroy before Create. No Action",{appInstanceId:e.context.appInstanceId});this.isDestroyed=!0,this.state.isRunning=!1,this.logger.info("Begin Lifecycle Destroy");const{config:t}=this.provider,{success:n}=yield this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"destroy"}),(e=>t.onDestroy?t.onDestroy(e):Promise.resolve()),!0);n&&this.sendLifecycleHandlerCompletedMessage(e.context.appInstanceId,"destroy")}))}handleLifecycleChange(e,t,n){return o(this,void 0,void 0,(function*(){let s=!1;try{yield t(e),s=!0}catch(t){const{appInstanceId:s}=e.context;if(n){const n=`An fatal error occurred when handling a ${e.stage} lifecycle action. Closing app`;this.logger.error(n,{appInstanceId:s,error:t}),this.provider.sendFatalError(n,t)}else this.logger.error(`An error occurred when handling a ${e.stage} lifecycle action.`,{appInstanceId:s,error:t})}return{success:s}}))}getLifecycleChangeParams(){return{context:new r(this.provider,this.state.appInstanceId,this.state.appConfig,this.state.contactScope)}}sendLifecycleHandlerCompletedMessage(e,t){this.logger.debug(`Sending lifecycle ${t} completed signal`),this.provider.getProxy().sendLifecycleHandlerCompleted(e,t)}}class c extends s._S{constructor(e,t){super(e),this.channel=new MessageChannel,this.lifecycleManager=t,this.appLogger=new s.Hb({source:"app.appProxy",provider:e})}get proxyType(){return"AppProxy"}sendLifecycleHandlerCompleted(e,t){const n={type:"appLifecycleHandlerCompleted",stage:t,appInstanceId:e};this.sendOrQueueMessageToSubject(n)}tryCloseApp(e,t,n){const s={type:"closeApp",isFatalError:null!=t&&t,message:e,data:n};this.sendOrQueueMessageToSubject(s)}publish(e,t){const n={type:"appPublish",topic:e,data:t};this.sendOrQueueMessageToSubject(n)}initProxy(){const e={type:"connect-app-host-init",sdkVersion:s.lB,providerId:this.provider.id};var t,n,r;this.status.update({status:"initializing"}),this.channel.port1.onmessage=e=>this.consumerMessageHandler(e),this.connectionTimer=s.q8.start(this.connectionTimeout.bind(this),(t=this.provider.config,Math.max(1,Math.min(6e4,null!==(r=null===(n=t.workspace)||void 0===n?void 0:n.connectionTimeout)&&void 0!==r?r:5e3)))),window.parent.postMessage(e,"*",[this.channel.port2]),this.appLogger.debug("Send connect message to configure proxy")}sendMessageToSubject(e){this.channel.port1.postMessage(e)}getUpstreamMessageOrigin(){if(null===document||void 0===document?void 0:document.location){const{origin:e,pathname:t}=document.location;return{_type:"app",providerId:this.provider.id,origin:e,path:t}}return{_type:"app",providerId:this.provider.id,origin:"unknown",path:"unknown"}}handleConnectionAcknowledge(e){this.connectionTimer.complete()?super.handleConnectionAcknowledge(e):this.appLogger.error("Workspace connection acknowledge received after timeout. App is not connected to workspace.",{timeout:this.connectionTimer.timeoutMs})}handleMessageFromSubject(e){"appLifecycle"===e.type?this.lifecycleManager.handleLifecycleChangeMessage(e).catch((e=>{this.appLogger.error("An error occurred when invoking handleLifecycleChangeMessage",{error:e})})):super.handleMessageFromSubject(e)}connectionTimeout(e){this.status.update({status:"error",reason:"Workspace connection timeout",details:Object.assign({},e)}),this.publishError({message:"App failed to connect to workspace in the allotted time",key:"workspaceConnectTimeout",details:Object.assign({},e),isFatal:!0,proxyStatus:{initialized:!1}})}addContextToLogger(){const{isRunning:e}=this.lifecycleManager.appState;if(null===document||void 0===document?void 0:document.location){const{origin:t,pathname:n}=document.location;return{appIsRunning:e,app:{origin:t,path:n}}}return{appIsRunning:e,app:{origin:"unknown",path:"unknown"}}}}class l extends s.Mf{constructor(e){super({config:e,proxyFactory:()=>this.createProxy()}),this.lifecycleManager=new a(this),this.logger=new s.Hb({provider:this,source:"app.provider"})}static init(e){const t=new l(e);return l.initializeProvider(t),{provider:t}}static get default(){return(0,s.WB)("AmazonConnectApp has not been initialized")}createProxy(){return new c(this,this.lifecycleManager)}onStart(e,t){this.lifecycleManager.onStart(e,t)}onStop(e){this.lifecycleManager.onStop(e)}offStart(e){this.lifecycleManager.offStart(e)}offStop(e){this.lifecycleManager.offStop(e)}sendCloseAppRequest(e){this.getProxy().tryCloseApp(e,!1)}sendError(e,t){this.logger.error(e,t)}sendFatalError(e,t){this.getProxy().tryCloseApp(e,!0,t)}subscribe(e,t){this.getProxy().subscribe(e,t)}unsubscribe(e,t){this.getProxy().unsubscribe(e,t)}publish(e,t){this.getProxy().publish(e,t)}}!function(e){e.CurrentContactId="CURRENT_CONTACT"}(i||(i={}))},927:(e,t,n)=>{n.r(t),n.d(t,{AgentClient:()=>d,AgentRoutes:()=>i,AgentTopicKey:()=>c,ContactClient:()=>u,ContactLifecycleTopicKey:()=>a,ContactRoutes:()=>o,contactNamespace:()=>r});var s=n(968);const r="aws.connect.contact";var i,o,a,c;!function(e){e.getARN="agent/getARN",e.getName="agent/getName",e.getState="agent/getState",e.getRoutingProfile="agent/getRoutingProfile",e.getChannelConcurrency="agent/getChannelConcurrency",e.getExtension="agent/getExtension",e.getDialableCountries="agent/getDialableCountries",e.setAvailabilityState="agent/setAvailabilityState",e.setAvailabilityStateByName="agent/setAvailabilityStateByName",e.setOffline="agent/setOffline",e.listAvailabilityStates="agent/listAvailabilityStates",e.listQuickConnects="agent/listQuickConnects"}(i||(i={})),function(e){e.getAttributes="contact/getAttributes",e.getInitialContactId="contact/getInitialContactId",e.getType="contact/getType",e.getStateDuration="contact/getStateDuration",e.getQueue="contact/getQueue",e.getQueueTimestamp="contact/getQueueTimestamp",e.getDescription="contact/getDescription",e.getReferences="contact/getReferences",e.getChannelType="contact/getChannelType",e.addParticipant="contact/addParticipant",e.transfer="contact/transfer",e.accept="contact/accept",e.clear="contact/clear"}(o||(o={})),function(e){e.StartingACW="contact/acw",e.Connected="contact/connected",e.Destroyed="contact/destroy",e.Missed="contact/missed",e.Cleared="contact/cleared"}(a||(a={})),function(e){e.StateChanged="agent/stateChange"}(c||(c={}));var l=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};class d extends s.sS{constructor(e){super(r,e)}getARN(){return l(this,void 0,void 0,(function*(){const{ARN:e}=yield this.context.proxy.request(i.getARN);return e}))}getName(){return l(this,void 0,void 0,(function*(){const{name:e}=yield this.context.proxy.request(i.getName);return e}))}getState(){return this.context.proxy.request(i.getState)}getRoutingProfile(){return this.context.proxy.request(i.getRoutingProfile)}getChannelConcurrency(){return this.context.proxy.request(i.getChannelConcurrency)}getExtension(){return l(this,void 0,void 0,(function*(){const{extension:e}=yield this.context.proxy.request(i.getExtension);return e}))}getDialableCountries(){return l(this,void 0,void 0,(function*(){const{dialableCountries:e}=yield this.context.proxy.request(i.getDialableCountries);return e}))}onStateChanged(e){this.context.proxy.subscribe({key:c.StateChanged},e)}offStateChanged(e){this.context.proxy.unsubscribe({key:c.StateChanged},e)}setAvailabilityState(e){return this.context.proxy.request(i.setAvailabilityState,{agentStateARN:e})}setAvailabilityStateByName(e){return this.context.proxy.request(i.setAvailabilityStateByName,{agentStateName:e})}setOffline(){return this.context.proxy.request(i.setOffline,{})}listAvailabilityStates(){return this.context.proxy.request(i.listAvailabilityStates)}listQuickConnects(e,t){return this.context.proxy.request(i.listQuickConnects,{queueARNs:e,options:t})}}var h=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};class u extends s.sS{constructor(e){super(r,e)}getAttributes(e,t){const n={contactId:e,attributes:t};return this.context.proxy.request(o.getAttributes,n)}getAttribute(e,t){return h(this,void 0,void 0,(function*(){return(yield this.getAttributes(e,[t]))[t]}))}getInitialContactId(e){return h(this,void 0,void 0,(function*(){return(yield this.context.proxy.request(o.getInitialContactId,{contactId:e})).initialContactId}))}getType(e){return h(this,void 0,void 0,(function*(){return(yield this.context.proxy.request(o.getType,{contactId:e})).type}))}getStateDuration(e){return h(this,void 0,void 0,(function*(){return(yield this.context.proxy.request(o.getStateDuration,{contactId:e})).stateDuration}))}getQueue(e){return this.context.proxy.request(o.getQueue,{contactId:e})}getQueueTimestamp(e){return h(this,void 0,void 0,(function*(){return(yield this.context.proxy.request(o.getQueueTimestamp,{contactId:e})).queueTimestamp}))}onStartingAcw(e,t){this.context.proxy.subscribe({key:a.StartingACW,parameter:t},e)}onDestroyed(e,t){this.context.proxy.subscribe({key:a.Destroyed,parameter:t},e)}onConnected(e,t){this.context.proxy.subscribe({key:a.Connected,parameter:t},e)}onMissed(e,t){this.context.proxy.subscribe({key:a.Missed,parameter:t},e)}offStartingAcw(e,t){this.context.proxy.unsubscribe({key:a.StartingACW,parameter:t},e)}offDestroyed(e,t){this.context.proxy.unsubscribe({key:a.Destroyed,parameter:t},e)}offMissed(e,t){this.context.proxy.unsubscribe({key:a.Missed,parameter:t},e)}offConnected(e,t){this.context.proxy.unsubscribe({key:a.Connected,parameter:t},e)}getChannelType(e){return h(this,void 0,void 0,(function*(){return yield this.context.proxy.request(o.getChannelType,{contactId:e})}))}addParticipant(e,t){return this.context.proxy.request(o.addParticipant,{contactId:e,quickConnect:t})}transfer(e,t){return this.context.proxy.request(o.transfer,{contactId:e,quickConnect:t})}onCleared(e,t){this.context.proxy.subscribe({key:a.Cleared,parameter:t},e)}offCleared(e,t){this.context.proxy.unsubscribe({key:a.Cleared,parameter:t},e)}accept(e){return this.context.proxy.request(o.accept,{contactId:e})}clear(e){return this.context.proxy.request(o.clear,{contactId:e})}}},968:(e,t,n)=>{let s;function r(e){if(!s)throw new Error(null!=e?e:"Attempted to get Global AmazonConnectProvider that has not been set.");return s}n.d(t,{Mf:()=>M,sS:()=>P,Hb:()=>O,_y:()=>T,_S:()=>S,q8:()=>w,WB:()=>r,lB:()=>j});class i extends Error{constructor({reason:e,namespace:t,errorKey:n,details:s}){super(`ConnectError with error key "${n}"`),this.errorType=i.ErrorType,this.namespace=t,this.errorKey=n,this.reason=e,this.details=null!=s?s:{}}}i.ErrorType="ConnectError";class o{constructor({provider:e,loggerKey:t}){this.events=new Map,this.logger=new O({provider:e,source:"emitter",mixin:()=>({emitterLoggerKey:t})})}on(e,t){const n=this.events.get(e);n?n.add(t):this.events.set(e,new Set([t]))}off(e,t){const n=this.events.get(e);n&&(n.delete(t),n.size<1&&this.events.delete(e))}getHandlers(e){var t;return Array.from(null!==(t=this.events.get(e))&&void 0!==t?t:[])}}var a=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};class c extends o{emit(e,t){return a(this,void 0,void 0,(function*(){const n=this.getHandlers(e);yield Promise.allSettled(n.map((n=>a(this,void 0,void 0,(function*(){try{yield n(t)}catch(t){this.logger.error("An error occurred when invoking event handler",{error:t,parameter:e})}})))))}))}}function l(){return"randomUUID"in crypto?crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}class d{constructor(){this.idsByHandler=new Map,this.handlersById=new Map}add(e){const t=this.idsByHandler.get(e);if(t)return{handlerId:t};const n=l();return this.idsByHandler.set(e,n),this.handlersById.set(n,e),{handlerId:n}}getIdByHandler(e){var t;return null!==(t=this.idsByHandler.get(e))&&void 0!==t?t:null}getHandlerById(e){var t;return null!==(t=this.handlersById.get(e))&&void 0!==t?t:null}get(){return[...this.idsByHandler.entries()].map((([e,t])=>({handler:e,handlerId:t})))}delete(e){const t=this.idsByHandler.get(e);return t&&this.handlersById.delete(t),this.idsByHandler.delete(e),{isEmpty:this.idsByHandler.size<1}}size(){return this.idsByHandler.size}}class h{constructor(){this.simpleSubscriptions=new Map,this.paramSubscriptions=new Map}add({namespace:e,key:t,parameter:n},s){var r,i,o,a,c;if(n){if(!this.paramSubscriptions.has(e))return void this.paramSubscriptions.set(e,new Map([[t,new Map([[n,s]])]]));if(!(null===(r=this.paramSubscriptions.get(e))||void 0===r?void 0:r.has(t)))return void(null===(i=this.paramSubscriptions.get(e))||void 0===i||i.set(t,new Map([[n,s]])));null===(a=null===(o=this.paramSubscriptions.get(e))||void 0===o?void 0:o.get(t))||void 0===a||a.set(n,s)}else{if(!this.simpleSubscriptions.has(e))return void this.simpleSubscriptions.set(e,new Map([[t,s]]));null===(c=this.simpleSubscriptions.get(e))||void 0===c||c.set(t,s)}}delete({namespace:e,key:t,parameter:n}){var s,r,i,o;n?(null===(r=null===(s=this.paramSubscriptions.get(e))||void 0===s?void 0:s.get(t))||void 0===r?void 0:r.delete(n))&&this.paramSubscriptions.get(e).get(t).size<1&&(null===(i=this.paramSubscriptions.get(e))||void 0===i||i.delete(t),this.paramSubscriptions.get(e).size<1&&this.paramSubscriptions.delete(e)):(null===(o=this.simpleSubscriptions.get(e))||void 0===o?void 0:o.delete(t))&&this.simpleSubscriptions.get(e).size<1&&this.simpleSubscriptions.delete(e)}get({namespace:e,key:t,parameter:n}){var s,r,i;return n?null===(i=null===(r=this.paramSubscriptions.get(e))||void 0===r?void 0:r.get(t))||void 0===i?void 0:i.get(n):null===(s=this.simpleSubscriptions.get(e))||void 0===s?void 0:s.get(t)}getOrAdd(e,t){let n=this.get(e);return n||(n=t(),this.add(e,n)),n}addOrUpdate(e,t,n){let s=this.get(e);return s=s?n(s):t(),this.add(e,s),s}getAllSubscriptions(){return[...Array.from(this.simpleSubscriptions.keys()).flatMap((e=>Array.from(this.simpleSubscriptions.get(e).keys()).flatMap((t=>({namespace:e,key:t}))))),...Array.from(this.paramSubscriptions.keys()).flatMap((e=>Array.from(this.paramSubscriptions.get(e).keys()).flatMap((t=>Array.from(this.paramSubscriptions.get(e).get(t).keys()).flatMap((n=>({namespace:e,key:t,parameter:n})))))))]}}class u{constructor(){this.subscriptions=new h}add(e,t){return this.subscriptions.getOrAdd(e,(()=>new d)).add(t)}get(e){var t,n;return null!==(n=null===(t=this.subscriptions.get(e))||void 0===t?void 0:t.get())&&void 0!==n?n:[]}getById(e,t){var n,s;return null!==(s=null===(n=this.subscriptions.get(e))||void 0===n?void 0:n.getHandlerById(t))&&void 0!==s?s:null}delete(e,t){var n,s;null!==(s=null===(n=this.subscriptions.get(e))||void 0===n?void 0:n.delete(t).isEmpty)&&void 0!==s&&s&&this.subscriptions.delete(e)}size(e){var t,n;return null!==(n=null===(t=this.subscriptions.get(e))||void 0===t?void 0:t.size())&&void 0!==n?n:0}isEmpty(e){return 0===this.size(e)}getAllSubscriptions(){return this.subscriptions.getAllSubscriptions()}getAllSubscriptionHandlerIds(){return this.subscriptions.getAllSubscriptions().reduce(((e,t)=>e.concat(this.get(t).map((({handlerId:e})=>({topic:t,handlerId:e}))))),[])}}class g{constructor({sendMetric:e,metricName:t,metricOptions:n}){this.unit="Milliseconds",this.sendMetric=e,this.startTime=performance.now(),this.metricName=t,this.dimensions=(null==n?void 0:n.dimensions)?n.dimensions:{},this.optionalDimensions=(null==n?void 0:n.optionalDimensions)?n.optionalDimensions:{}}stopDurationCounter(){const e=Math.round(performance.now()-this.startTime);return this.sendMetric({metricName:this.metricName,unit:this.unit,value:e,dimensions:this.dimensions,optionalDimensions:this.optionalDimensions}),{duration:e}}}class p{constructor(e){this._proxy=null,this.namespace=e.namespace,e.provider&&"function"==typeof e.provider?this.providerFactory=e.provider:this.provider=e.provider}recordSuccess(e,t){var n;const s=Object.assign({},null!==(n=null==t?void 0:t.dimensions)&&void 0!==n?n:{}),r=Object.assign(Object.assign({},t),{dimensions:s});this.recordCount(e,0,r)}recordError(e,t){var n;const s=Object.assign({},null!==(n=null==t?void 0:t.dimensions)&&void 0!==n?n:{}),r=Object.assign(Object.assign({},t),{dimensions:s});this.recordCount(e,1,r)}recordCount(e,t,n){this.sendMetric({metricName:e,unit:"Count",value:t,dimensions:null==n?void 0:n.dimensions,optionalDimensions:null==n?void 0:n.optionalDimensions})}startDurationCounter(e,t){return new g({sendMetric:this.sendMetric.bind(this),metricName:e,metricOptions:t})}sendMetric({metricName:e,unit:t,value:n,dimensions:s,optionalDimensions:r}){s&&function(e,t){if(Object.keys(e).length+Object.keys(null!=t?t:{}).length>30)throw new Error("Cannot add more than 30 dimensions to a metric")}(s,r);const i={metricName:e,unit:t,value:n,dimensions:s,optionalDimensions:r},o=new Date;this.getProxy().sendMetric({metricData:i,time:o,namespace:this.namespace})}getProvider(){return this.provider||(this.provider=this.providerFactory?this.providerFactory():r()),this.provider}getProxy(){return this._proxy||(this._proxy=this.getProvider().getProxy()),this._proxy}}class m{constructor(e){this.requestMap=new Map,this.logger=new O({provider:e,source:"core.requestManager"})}processRequest(e){const{requestId:t}=e;return function(e,t,n,s){const r=Math.max(1,null!=s?s:3e4);return new Promise(((s,o)=>{let a=!1;const c=setTimeout((()=>{n({timeoutMs:r,request:e}),o(function(e,t){const{namespace:n,command:s,data:r}=e;return{namespace:n,reason:"Client Timeout",details:{command:s,requestData:r,timeoutMs:t},errorKey:"clientTimeout"}}(e,r)),a=!0}),r);t((e=>{clearTimeout(c),a||(e.isError?o(new i(e)):s(e.data))}))}))}(e,(e=>this.requestMap.set(t,e)),(({request:e,timeoutMs:t})=>this.handleTimeout(e,t)))}processResponse(e){const{requestId:t}=e,n=this.requestMap.get(t);n?(n(e),this.requestMap.delete(t)):this.logger.error("Returned a response message with no handler",{message:e})}handleTimeout(e,t){const{requestId:n,namespace:s,command:r}=e;this.requestMap.delete(n),this.logger.error("Client request timeout",{requestId:n,namespace:s,command:r,timeoutMs:t})}}var y=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};function v(e){try{switch(e.type){case"acknowledge":case"error":case"childConnectionClose":default:return e;case"childDownstreamMessage":return Object.assign(Object.assign({},e),{message:v(e.message)});case"publish":{const{data:t}=e,n=y(e,["data"]);return Object.assign({},n)}case"response":if(e.isError)return Object.assign(Object.assign({},e),{details:{command:e.details.command}});{const{data:t}=e,n=y(e,["data"]);return Object.assign({},n)}}}catch(t){return{messageDetails:"error when sanitizing downstream message",message:e,error:t}}}class f{constructor(e,t){this.provider=e,this.relayChildUpstreamMessage=t,this.messagePorts=new Map,this.logger=new O({provider:e,source:"childConnectionManager"})}addChannel(e){const{connectionId:t}=e;this.messagePorts.has(t)?this.logger.error("Attempted to add child connection that already exists. No action",{connectionId:t}):(this.setupPort(e),this.logger.debug("Child port added",{connectionId:t}))}updateChannelPort(e){var t;const{connectionId:n}=e,s=null===(t=this.messagePorts.get(n))||void 0===t?void 0:t.port;s?(s.onmessage=null,s.close(),this.setupPort(e),this.logger.info("Updated child port",{connectionId:n})):this.logger.error("Attempted to update child connection that does not exist No action",{connectionId:n})}setupPort({connectionId:e,port:t,providerId:n}){const s=this.createMessageHandler(e,n);t.addEventListener("message",s),t.start(),this.messagePorts.set(e,{port:t,handler:s,providerId:n}),this.relayChildUpstreamMessage({type:"childUpstream",connectionId:e,sourceProviderId:n,parentProviderId:this.provider.id,message:{type:"childConnectionReady"}})}handleDownstreamMessage({connectionId:e,message:t,targetProviderId:n}){const s=this.messagePorts.get(e);if(!s)return void this.logger.warn("Attempted to route downstream message to child message port that does not exist",{connectionId:e,message:v(t)});const{port:r,providerId:i}=s;i&&i!==n?this.logger.error("Downstream target message did not match target provider id. Not sending message.",{connectionId:e,targetProviderId:n,actualProviderId:i,message:v(t)}):r.postMessage(t)}handleCloseMessage({connectionId:e}){const t=this.messagePorts.get(e);if(!t)return void this.logger.warn("Attempted to close child message port that was not found",{connectionId:e});const{port:n,handler:s}=t;n.removeEventListener("message",s),n.close(),this.messagePorts.delete(e),this.logger.debug("Removed child message channel",{connectionId:e})}createMessageHandler(e,t){return n=>this.relayChildUpstreamMessage({type:"childUpstream",sourceProviderId:t,parentProviderId:this.provider.id,connectionId:e,message:n.data})}}class b{constructor(e){this.errorHandlers=new Set,this.logger=new O({provider:e,source:"core.proxy.error"})}invoke(e){const{message:t,key:n,details:s,isFatal:r,connectionStatus:i}=e;this.logger.error(t,{key:n,details:s,isFatal:r,connectionStatus:i},{duplicateMessageToConsole:!0,remoteIgnore:!0}),[...this.errorHandlers].forEach((t=>{try{t(e)}catch(t){this.logger.error("An error occurred within a AmazonConnectErrorHandler",{handlerError:t,originalError:e})}}))}onError(e){this.errorHandlers.add(e)}offError(e){this.errorHandlers.delete(e)}}class C{constructor({provider:e,sendHealthCheck:t,getUpstreamMessageOrigin:n}){this.connectionId=null,this.healthCheckInterval=null,this.healthCheckTimeout=null,this.sendHealthCheck=t,this.getUpstreamMessageOrigin=n,this.sendHealthCheckInterval=null,this.lastHealthCheckResponse=null,this._status="unknown",this.logger=new O({source:"core.proxy.health-check",provider:e,mixin:()=>({connectionId:this.connectionId})}),this.events=new c({provider:e,loggerKey:"core.proxy.health-check"})}get status(){return this._status}get isRunning(){return null!==this.sendHealthCheckInterval}get lastCheckCounter(){var e,t;return null!==(t=null===(e=this.lastHealthCheckResponse)||void 0===e?void 0:e.counter)&&void 0!==t?t:null}get lastCheckTime(){var e,t;return null!==(t=null===(e=this.lastHealthCheckResponse)||void 0===e?void 0:e.time)&&void 0!==t?t:null}start({healthCheckInterval:e,connectionId:t}){this.connectionId=t,this.healthCheckInterval=e,this.clearInterval(),e<=0?this.logger.debug("Health check disabled"):e<1e3?this.logger.error("Health check interval is less than 1 second. Not running",{interval:e}):(this.sendHealthCheckMessage(),this.sendHealthCheckInterval=setInterval((()=>this.sendHealthCheckMessage()),e),this.startTimeout())}stop(){this.clearInterval(),this.clearTimeout()}handleResponse(e){this.setHealthy({time:e.time,counter:e.counter})}sendHealthCheckMessage(){this.sendHealthCheck({type:"healthCheck",messageOrigin:this.getUpstreamMessageOrigin()})}startTimeout(){this.healthCheckInterval?(this.clearTimeout(),this.healthCheckTimeout=setTimeout((()=>{this.setUnhealthy()}),3*this.healthCheckInterval)):this.logger.error("Health check interval not set. Cannot start timeout")}clearInterval(){this.sendHealthCheckInterval&&(clearInterval(this.sendHealthCheckInterval),this.sendHealthCheckInterval=null)}clearTimeout(){this.healthCheckTimeout&&(clearTimeout(this.healthCheckTimeout),this.healthCheckTimeout=null)}setUnhealthy(){if("unhealthy"!==this._status){const e=this._status;this.logger.info("Connection unhealthy",{previousStatus:e}),this._status="unhealthy",this.emitStatusChanged("unhealthy",e)}}setHealthy(e){if(this.lastHealthCheckResponse=Object.assign({},e),"healthy"!==this._status){const e=this._status;this.logger.debug("Connection healthy",{previousStatus:e}),this._status="healthy",this.emitStatusChanged("healthy",e)}this.startTimeout()}emitStatusChanged(e,t){var n,s,r,i;this.events.emit(C.statusChangedKey,{status:e,previousStatus:t,lastCheckTime:null!==(s=null===(n=this.lastHealthCheckResponse)||void 0===n?void 0:n.time)&&void 0!==s?s:null,lastCheckCounter:null!==(i=null===(r=this.lastHealthCheckResponse)||void 0===r?void 0:r.counter)&&void 0!==i?i:null})}onStatusChanged(e){this.events.on(C.statusChangedKey,e)}offStatusChanged(e){this.events.off(C.statusChangedKey,e)}}C.statusChangedKey="statusChanged";class x{constructor(e){this.status="notConnected",this.changeHandlers=new Set,this.logger=new O({source:"core.proxy.connection-status-manager",provider:e,mixin:()=>({status:this.status})})}getStatus(){return this.status}update(e){this.status=e.status,this.logger.trace("Proxy Connection Status Changed",{status:e.status}),[...this.changeHandlers].forEach((t=>{try{t(e)}catch(e){this.logger.error("An error occurred within a ProxyConnectionChangedHandler",{error:e})}}))}onChange(e){this.changeHandlers.add(e)}offChange(e){this.changeHandlers.delete(e)}}var I;class S{constructor(e){this.provider=e,this.logger=new O({source:"core.proxy",provider:e,mixin:()=>({proxyType:this.proxyType,connectionId:this.connectionId})}),this.requestManager=new m(e),this.status=new x(e),this.errorService=new b(e),this.upstreamMessageQueue=[],this.connectionEstablished=!1,this.isInitialized=!1,this.subscriptions=new u,this.connectionId=null,this.channelManager=new f(e,this.sendOrQueueMessageToSubject.bind(this)),this.healthCheck=new C({provider:e,sendHealthCheck:this.sendOrQueueMessageToSubject.bind(this),getUpstreamMessageOrigin:this.getUpstreamMessageOrigin.bind(this)})}init(){if(this.isInitialized)throw new Error("Proxy already initialized");this.isInitialized=!0,this.initProxy()}request(e,t,n,s){const r=function(e,t,n,s){return{type:"request",namespace:e,command:t,requestId:l(),data:n,messageOrigin:s}}(e,t,n,null!=s?s:this.getUpstreamMessageOrigin()),i=this.requestManager.processRequest(r);return this.sendOrQueueMessageToSubject(r),i}subscribe(e,t,n){const{handlerId:s}=this.subscriptions.add(e,t),r={type:"subscribe",topic:e,messageOrigin:null!=n?n:this.getUpstreamMessageOrigin(),handlerId:s};this.sendOrQueueMessageToSubject(r)}unsubscribe(e,t,n){if(this.subscriptions.delete(e,t),this.subscriptions.isEmpty(e)){const t={type:"unsubscribe",topic:e,messageOrigin:null!=n?n:this.getUpstreamMessageOrigin()};this.sendOrQueueMessageToSubject(t)}}log(e){const t=function({level:e,source:t,message:n,loggerId:s,data:r},i,o){const a=r?JSON.parse(JSON.stringify(r)):void 0;return{type:"log",level:e,time:new Date,source:t,message:n,loggerId:s,data:a,context:i,messageOrigin:o}}(e,this.addContextToLogger(),this.getUpstreamMessageOrigin());this.sendOrQueueMessageToSubject(t)}sendLogMessage(e){"log"===e.type?(e.context=Object.assign(Object.assign({},e.context),this.addContextToLogger()),this.sendOrQueueMessageToSubject(e)):this.logger.error("Attempted to send invalid log message",{message:e})}sendMetric({metricData:e,time:t,namespace:n}){const s=function({metricData:e,time:t,namespace:n},s){var r,i;return{type:"metric",namespace:n,metricName:e.metricName,unit:e.unit,value:e.value,time:t,dimensions:null!==(r=e.dimensions)&&void 0!==r?r:{},optionalDimensions:null!==(i=e.optionalDimensions)&&void 0!==i?i:{},messageOrigin:s}}({metricData:e,time:t,namespace:n},this.getUpstreamMessageOrigin());this.sendOrQueueMessageToSubject(s)}sendMetricMessage(e){"metric"===e.type?this.sendOrQueueMessageToSubject(e):this.logger.error("Attempted to send invalid metric message",{metricMessage:e})}sendOrQueueMessageToSubject(e){this.connectionEstablished?this.sendMessageToSubject(e):this.upstreamMessageQueue.push(e)}consumerMessageHandler(e){if(!this.isInitialized)return void this.logger.error("Attempted to process message from subject prior to proxy being initializing. Message not processed",{originalMessageEventData:e.data});const{data:t}=e;if(!("type"in t))return void this.logger.warn("Unknown inbound message",{originalMessageEventData:t});const n=t;this.handleMessageFromSubject(n)}handleMessageFromSubject(e){this.handleDefaultMessageFromSubject(e)}handleDefaultMessageFromSubject(e){switch(e.type){case"acknowledge":this.handleConnectionAcknowledge(e);break;case"response":this.handleResponse(e);break;case"publish":this.handlePublish(e);break;case"error":this.handleError(e);break;case"childDownstreamMessage":this.channelManager.handleDownstreamMessage(e);break;case"childConnectionClose":this.channelManager.handleCloseMessage(e);break;case"healthCheckResponse":this.healthCheck.handleResponse(e);break;default:return void this.logger.error("Unknown inbound message",{originalMessageEventData:e})}}handleConnectionAcknowledge(e){for(this.connectionId=e.connectionId,this.status.update({status:"ready",connectionId:e.connectionId}),this.connectionEstablished=!0;this.upstreamMessageQueue.length;){const e=this.upstreamMessageQueue.shift();this.sendMessageToSubject(e)}this.healthCheck.start(e)}handleResponse(e){this.requestManager.processResponse(e)}handlePublish(e){const{handlerId:t,topic:n}=e;if(t){const s=this.subscriptions.getById(n,t);s&&this.handleAsyncSubscriptionHandlerInvoke({handler:s,handlerId:t},e)}else this.subscriptions.get(n).map((t=>{this.handleAsyncSubscriptionHandlerInvoke(t,e)}))}handleError(e){if(e.isFatal){const{message:t,type:n}=e,s=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n}(e,["message","type"]);this.status.update({status:"error",reason:t,details:s})}this.publishError({message:e.message,key:e.key,details:e.details,isFatal:e.isFatal,proxyStatus:e.status})}publishError(e){const t=Object.assign(Object.assign({},e),{connectionStatus:this.connectionStatus});this.errorService.invoke(t)}handleAsyncSubscriptionHandlerInvoke(e,t){return n=this,s=arguments,i=function*({handler:e,handlerId:t},{topic:n,data:s}){try{yield e(s)}catch(e){this.logger.error("An error occurred when handling subscription",{topic:n,error:e,handlerId:t})}},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}c((i=i.apply(n,s||[])).next())}));var n,s,r,i}get connectionStatus(){return this.status.getStatus()}onError(e){this.errorService.onError(e)}offError(e){this.errorService.offError(e)}onConnectionStatusChange(e){this.status.onChange(e)}offConnectionStatusChange(e){this.status.offChange(e)}onHealthCheckStatusChanged(e){this.healthCheck.onStatusChanged(e)}offHealthCheckStatusChanged(e){this.healthCheck.offStatusChanged(e)}addChildChannel(e){this.channelManager.addChannel(e)}updateChildChannelPort(e){this.channelManager.updateChannelPort(e)}resetConnection(e){var t;this.connectionEstablished=!1,this.status.update({status:"reset",reason:e});const n=this.subscriptions.getAllSubscriptionHandlerIds();this.logger.info("Resetting proxy",{reason:e,subscriptionHandlerCount:null!==(t=null==n?void 0:n.length)&&void 0!==t?t:-1}),null==n||n.map((({topic:e,handlerId:t})=>({type:"subscribe",topic:e,messageOrigin:this.getUpstreamMessageOrigin(),handlerId:t}))).forEach((e=>this.sendOrQueueMessageToSubject(e)))}}class w{constructor(e,t){this.timeoutMs=t,this.onCancelled=e,this.timeout=setTimeout((()=>this.handleCancel()),this.timeoutMs),this.status="running",this.logger=new O({source:"core.utility.timeout-tracker",mixin:()=>({timeoutMs:this.timeoutMs,timeoutTrackerStatus:this.status})})}static start(e,t){return new w(e,t)}complete(){switch(this.status){case"running":return this.handleComplete();case"completed":return this.logger.debug("TimeoutTracker already marked complete. No action."),!0;case"cancelled":return this.logger.info("Attempted to complete a TimeoutTracker that has already been cancelled"),!1}}isCancelled(){return"cancelled"===this.status}getStatus(){return this.status}handleCancel(){switch(this.status){case"running":this.status="cancelled",this.logger.info("TimeoutTracker has timed out. Invoking onCancelled Handler"),this.invokeOnCancelled();break;case"completed":this.logger.debug("Cancel operation for TimerTracker invoked after already completed. No action.");break;default:throw new Error("Cancel operation in TimerTracker called during an unexpected time.")}}handleComplete(){return this.status="completed",clearTimeout(this.timeout),!0}invokeOnCancelled(){try{this.onCancelled({timeoutMs:this.timeoutMs})}catch(e){this.logger.error("Error when attempting to invoke TimeoutTrackerCancelledHandler",{error:e})}}}class M{constructor({config:e,proxyFactory:t}){if(this._id=l(),!t)throw new Error("Attempted to get Proxy before setting up factory");if(!e)throw new Error("Failed to include config");this.proxyFactory=t,this._config=e}get id(){return this._id}getProxy(){return this.proxy||(this.proxy=this.proxyFactory(this),this.proxy.init()),this.proxy}get config(){return Object.assign({},this._config)}onError(e){this.getProxy().onError(e)}offError(e){this.getProxy().offError(e)}static initializeProvider(e){if(this.isInitialized){const e="Attempted to initialize provider more than one time.",t={};try{const t=r();new O({source:"core.amazonConnectProvider.init",provider:t}).error(e)}catch(e){t.loggingError=null==e?void 0:e.message}throw new i({errorKey:"attemptInitializeMultipleProviders",reason:e,details:t})}return function(e){if(s)throw new Error("Global Provider is already set");s=e}(e),this.isInitialized=!0,e.getProxy(),e}}M.isInitialized=!1,function(e){e[e.trace=1]="trace",e[e.debug=2]="debug",e[e.info=3]="info",e[e.warn=4]="warn",e[e.error=5]="error"}(I||(I={}));class k{constructor(e){this.mixin=e}getTransformedData(e,t){return this.mixin?Object.assign(Object.assign({},null!=t?t:{}),this.mixin(null!=t?t:{},e)):t}}class O{constructor(e){this._proxy=null,this._logToConsoleLevel=null,this.loggerId=function(e){const t=new Uint8Array(Math.ceil(4));return crypto.getRandomValues(t),Array.from(t,(e=>e.toString(16).padStart(2,"0"))).join("").substring(0,8)}(),"string"==typeof e?(this.source=e,this.dataTransformer=new k(void 0)):(this.source=e.source,e.provider&&"function"==typeof e.provider?this.providerFactory=e.provider:this.provider=e.provider,this.dataTransformer=new k(e.mixin),this.logOptions=e.options)}trace(e,t,n){this.log(I.trace,e,t,n)}debug(e,t,n){this.log(I.debug,e,t,n)}info(e,t,n){this.log(I.info,e,t,n)}warn(e,t,n){this.log(I.warn,e,t,n)}error(e,t,n){this.log(I.error,e,t,n)}log(e,t,n,s){const r=this.dataTransformer.getTransformedData(e,n);this.ignoreRemote(s)||this.getProxy().log({level:e,source:this.source,loggerId:this.loggerId,message:t,data:r}),this.applyDuplicateMessageToConsole(e,s)&&function(e,t,n){if(n)switch(e){case I.error:console.error(t,n);break;case I.warn:console.warn(t,n);break;case I.info:console.info(t,n);break;case I.debug:console.debug(t,n);break;case I.trace:console.trace(t,n);break;default:console.log(t,n)}else switch(e){case I.error:console.error(t);break;case I.warn:console.warn(t);break;case I.info:console.info(t);break;case I.debug:console.debug(t);break;case I.trace:console.trace(t);break;default:console.log(t)}}(e,t,r)}getProvider(){return this.provider||(this.provider=this.providerFactory?this.providerFactory():r()),this.provider}getProxy(){return this._proxy||(this._proxy=this.getProvider().getProxy()),this._proxy}applyDuplicateMessageToConsole(e,t){return(null==t?void 0:t.duplicateMessageToConsole)||this.getLogConsoleLevel()<=e}getLogConsoleLevel(){var e,t,n,s;return this._logToConsoleLevel||(this._logToConsoleLevel=(null===(e=this.logOptions)||void 0===e?void 0:e.minLogToConsoleLevelOverride)?this.logOptions.minLogToConsoleLevelOverride:null!==(s=null===(n=null===(t=this.getProvider().config)||void 0===t?void 0:t.logging)||void 0===n?void 0:n.minLogToConsoleLevel)&&void 0!==s?s:I.error),this._logToConsoleLevel}ignoreRemote(e){var t,n,s;return null!==(n=null===(t=this.logOptions)||void 0===t?void 0:t.remoteIgnore)&&void 0!==n&&n||null!==(s=null==e?void 0:e.remoteIgnore)&&void 0!==s&&s}}class A{constructor(e,t){this.engineContext=e,this.moduleNamespace=t}get proxy(){if(!this.moduleProxy){const e=this.engineContext.getProxy(),t=this.moduleNamespace;this.moduleProxy=function(e,t){return{request:(n,s)=>e.request(t,n,s),subscribe:(n,s)=>e.subscribe(Object.assign(Object.assign({},n),{namespace:t}),s),unsubscribe:(n,s)=>e.unsubscribe(Object.assign(Object.assign({},n),{namespace:t}),s),getProxyInfo:()=>({connectionStatus:e.connectionStatus,proxyType:e.proxyType}),onConnectionStatusChange:t=>e.onConnectionStatusChange(t),offConnectionStatusChange:t=>e.offConnectionStatusChange(t)}}(e,t)}return this.moduleProxy}createLogger(e){return this.engineContext.createLogger(e)}createMetricRecorder(e){return this.engineContext.createMetricRecorder(e)}}class T{constructor(e){this.provider=e}getProxy(){return this.getProvider().getProxy()}getModuleContext(e){return new A(this,e)}getProvider(){return this.provider?this.provider:r()}createLogger(e){return new O("object"==typeof e?Object.assign(Object.assign({},e),{provider:()=>this.getProvider()}):{source:e,provider:()=>this.getProvider()})}createMetricRecorder(e){return new p("object"==typeof e?Object.assign(Object.assign({},e),{provider:()=>this.getProvider()}):{namespace:e,provider:()=>this.getProvider()})}}class P{constructor(e,t){var n;this.namespace=e,this.context=null!==(n=null==t?void 0:t.context)&&void 0!==n?n:new T(null==t?void 0:t.provider).getModuleContext(e)}}const j="1.0.6"},607:function(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function a(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,s,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(n=1,s&&(r=2&a[0]?s.return:a[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,a[1])).done)return r;switch(s=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,s=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],s=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(67),o=n(927);i.AmazonConnectApp.init({onCreate:function(e){return s(void 0,void 0,void 0,(function(){var t,n,s,i,a,c;return r(this,(function(r){switch(r.label){case 0:return t=e.context.appInstanceId,console.log("VideoEngager ScheduleApp initialized: ",t),[4,(n=new o.AgentClient).getARN()];case 1:return s=r.sent(),[4,n.getName()];case 2:return i=r.sent(),a=s.split("/")[1],console.log("VideoEngager ScheduleApp agentARN: ",s),console.log("VideoEngager ScheduleApp agentName: ",i),console.log("VideoEngager ScheduleApp instanceId: ",a),c="{{VE_APP_URL}}?agentEmail="+a+i+"@{{VE_CUST_DOMAIN}}",console.log("VideoEngager ScheduleApp appUrl: ",c),window.location.replace(c),[2]}}))}))},onDestroy:function(e){return s(void 0,void 0,void 0,(function(){return r(this,(function(e){return console.log("VideoEngager ScheduleApp being destroyed"),[2]}))}))}}).provider}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();